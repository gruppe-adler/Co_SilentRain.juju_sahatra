#include "..\component.hpp"

params ["_plane"];

private _jm = (createGroup west) createUnit ["B_survivor_F", [0,0,0], [], 0, "NONE"];

_jm allowDamage false;
_jm setBehaviour "SAFE";
{_jm disableAI _x} forEach ["MOVE","ANIM","AUTOTARGET"];

[_jm] call grad_drop_fnc_removeAllGear;


[_jm,"HubBriefing_loop"] call grad_drop_fnc_switchMove;


[{
    params ["_plane","_jm"];
    _plane distance2d [0,0,0] > 100
},
{
    _this spawn {
        params ["_plane","_jm"];
        sleep 5;
         _jm attachTo [_plane,[ -1.25, 2.5, -4.9]];
        sleep 0.5;

        detach _jm;
        _jm setPos (_plane modelToWorldVisual [ -1.25, 2.5, -4.9]);
        _jm setFormDir (getDir _plane) + 60;
        _jm setDir (getDir _plane) + 60;
        _jm setAnimSpeedCoef 0.8;

        if (!isNil "grad_drop_debug") then {
            private _debugMarker = "VR_3DSelector_01_exit_F" createVehicleLocal [0,0,0];
            _debugMarker setPos _positionInWorld;
        };

        [_jm,"InBaseMoves_HandsBehindBack1"] call grad_drop_fnc_switchMove;
        sleep 2;
        [_jm,"InBaseMoves_HandsBehindBack1"] call grad_drop_fnc_switchMove;
    };
}, [_plane,_jm]] call CBA_fnc_waitUntilAndExecute;

_jm
