
missionNameSpace setVariable ["GRAD_drop_jmGreeting", true, true];
private _planesPrepared = missionNameSpace getVariable ["GRAD_drop_planesPrepared", []];
private _sounds = 
[
	"jumpmaster_greeting1",
	"jumpmaster_greeting2",
	"jumpmaster_greeting3",
	"jumpmaster_greeting4",
	"jumpmaster_greeting5",
	"jumpmaster_greeting6",
	"jumpmaster_greeting7"
];

[{
	params ["_args", "_handle"];
	_args params ["_planesPrepared", "_sounds"];

	if (!(missionNameSpace getVariable ["GRAD_drop_jmGreeting", false])) exitWith {
		[_handle] call CBA_fnc_removePerFrameHandler;
	};
	
	// systemchat "looping";

	{
		_x params ["_planeInBase"];
		private _jm = _planeInBase getVariable ["grad_drop_jumpmaster", objNull];
		private _lastWord = _jm getVariable ["grad_drop_lastWord", 1];
		private _greetings = _planeInBase getVariable ["grad_drop_greetings", []];
		if (_greetings isEqualTo []) then {
			_greetings = ["jumpmaster_greeting1", "jumpmaster_greeting2", "jumpmaster_greeting3", "jumpmaster_greeting4", "jumpmaster_greeting5", "jumpmaster_greeting6", "jumpmaster_greeting7"];
		};

		// systemChat (str _planeInBase + str _jm);
		private _randomValue = (random 3 > 2);
		private _timeElapsed = (CBA_missionTime - _lastWord > 3);
		// systemChat str _randomValue;
		// systemChat str _timeElapsed;

		if (_randomValue && _timeElapsed) then {

			// hint "bla";
			private _soundToPlay = selectRandom _greetings;
			_greetings deleteAt (_greetings find _soundToPlay);
			_planeInBase setVariable ["grad_drop_greetings", _greetings, true];

			[_jm, _soundToPlay, 65] remoteExec ["grad_drop_fnc_playSound",0,false];
			_jm setVariable ["grad_drop_lastWord", CBA_missionTime];
		};
	} forEach _planesPrepared;

}, 1, [_planesPrepared, _sounds]] call CBA_fnc_addPerFrameHandler;






